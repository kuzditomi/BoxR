var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i},BoxR;(function(n){var t=!1,r,i,u,f,e;r=function(){function n(n,t,i){this.active=!1,this.ctx=n,this.x=t,this.y=i}return n.prototype.Draw=function(){},n.prototype.Click=function(){return new i(!1,0)},n}(),n.Drawable=r,i=function(){function n(n,t){this.EdgeActivated=n,this.SquereActivated=t}return n}(),n.ClickResponse=i,u=function(n){function t(t,i,r,u,f,e){n.call(this,t,i,r),this.width=u,this.height=f,this.isHorizontal=e,this.squeres=[],this.mouseover=!1}return __extends(t,n),t.prototype.Draw=function(){this.ctx.strokeStyle="black",this.ctx.fillStyle=this.active?"darkslateblue":this.mouseover?"rgb(27,161,226)":"slateblue",this.ctx.beginPath(),this.isHorizontal?(this.ctx.moveTo(this.x+this.width/6,this.y),this.ctx.lineTo(this.x+this.width*5/6,this.y),this.ctx.lineTo(this.x+this.width,this.y+this.height/2),this.ctx.lineTo(this.x+this.width*5/6,this.y+this.height),this.ctx.lineTo(this.x+this.width/6,this.y+this.height),this.ctx.lineTo(this.x,this.y+this.height/2)):(this.ctx.moveTo(this.x+this.width/2,this.y),this.ctx.lineTo(this.x+this.width,this.y+this.height/6),this.ctx.lineTo(this.x+this.width,this.y+this.height*5/6),this.ctx.lineTo(this.x+this.width/2,this.y+this.height),this.ctx.lineTo(this.x,this.y+this.height*5/6),this.ctx.lineTo(this.x,this.y+this.height/6)),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke(),this.ctx.closePath()},t.prototype.MouseOver=function(n,t){this.active||(n>=this.x&&n<=this.x+this.width&&t>=this.y&&t<=this.y+this.height?(this.mouseover=!0,this.Draw()):this.mouseover&&(this.mouseover=!1,this.Draw()),this.ctx.stroke())},t.prototype.AddSquere=function(n){this.squeres.push(n)},t.prototype.Click=function(n,t){return this.active?new i(!1,0):n>=this.x&&n<=this.x+this.width&&t>=this.y&&t<=this.y+this.height?new i(!0,this.Activate()):new i(!1,0)},t.prototype.Activate=function(){this.active=!0;var n=0;return this.squeres.forEach(function(t){t.EdgeChecked()&&n++}),n},t}(r),n.Edge=u,f=function(n){function i(t,i,r,u){n.call(this,t,i,r),this.edgesChecked=0,this.width=u,this.animated=!1}return __extends(i,n),i.prototype.EdgeChecked=function(){return(this.edgesChecked++,this.edgesChecked==4)?(this.active=!0,!0):!1},i.prototype.Draw=function(){if(this.active)if(this.animated)this.ctx.fillStyle="rgba("+this.color+"1)",this.ctx.strokeStyle="black",this.ctx.beginPath(),this.ctx.rect(this.x,this.y,this.width,this.width),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke();else{this.color=t?"27,161,226,":"290,20,0,";var r=120,i=0,n=this,u=setInterval(function(){n.ctx.fillStyle="rgba("+n.color+i/r+")",n.ctx.strokeStyle="black",n.ctx.beginPath(),n.ctx.rect(n.x,n.y,n.width,n.width),n.ctx.closePath(),n.ctx.fill(),n.ctx.stroke(),i++,i===r&&clearInterval(u)},30);this.animated=!0}},i}(r),n.Squere=f,e=function(){function i(n){this.ctx=n.getContext("2d"),this.LeftOffset=n.offsetLeft,this.TopOffset=n.getBoundingClientRect().top,this.Width=n.clientWidth}return i.prototype.Init=function(i,r){var o,h,p,s,l;this.n=i,this.Clear(),this.edges=[],this.squares=[];var a=7,e=this.Width/(i*a+(i+1)+2),v=[e,2*e],y=[2*e,e],c=a*e,w=[c,e],b=[e,c];for(o=0;o<2*i+1;o++)for(this.edges[o]=[],h=o%2,p=h==0?i:i+1,s=0;s<p;s++)this.edges[o][s]=new u(this.ctx,y[h]+s*(c+e),v[h]+Math.floor(o/2)*(c+e),w[h],b[h],h==0),h==0&&o>0&&(l=new f(this.ctx,y[0]+s*(e+c)+e/2,v[1]+(o-2)/2*(c+e)+e/2,c-e),this.squares.push(l),this.edges[o][s].AddSquere(l),this.edges[o-1][s+1].AddSquere(l),this.edges[o-2][s].AddSquere(l),this.edges[o-1][s].AddSquere(l));t=r,this.selfScore=0,this.opponentScore=0,n.Manager.Server.UpdateRound(t)},i.prototype.Draw=function(){this.Clear(),this.edges.forEach(function(n){n.forEach(function(n){n.Draw()})}),this.squares.forEach(function(n){n.Draw()})},i.prototype.Clear=function(){this.ctx.clearRect(0,0,this.ctx.canvas.clientWidth,this.ctx.canvas.clientWidth)},i.prototype.Click=function(i){var u,f,r;t&&(u=i.pageX-this.LeftOffset,f=i.pageY-this.TopOffset,i.pageX&&i.pageY||(u=i.x-this.LeftOffset,f=i.y-this.TopOffset),r=this,this.edges.forEach(function(t,i){t.forEach(function(t,e){var o=t.Click(u,f);if(o.EdgeActivated){n.Manager.Hub.server.edgeClicked(i,e),r.selfScore+=o.SquereActivated,o.SquereActivated==0?r.NextRound():r.UpdateScore(),r.Draw();return}})}))},i.prototype.MouseMove=function(n){if(t){var i=n.clientX-this.LeftOffset,r=n.clientY-this.TopOffset;this.edges.forEach(function(n){n.forEach(function(n){n.MouseOver(i,r)})}),this.Draw()}},i.prototype.EdgeClickFromServer=function(n,t){if(!this.edges[n][t].active){var i=this.edges[n][t].Activate();this.opponentScore+=i,i==0?this.NextRound():this.UpdateScore(),this.Draw()}},i.prototype.UpdateScore=function(){if(n.Manager.Server.UpdateSelfScore(this.selfScore),n.Manager.Server.UpdateOpponentScore(this.opponentScore),this.selfScore+this.opponentScore==this.n*this.n){n.Manager.Hub.server.finishGame(),this.selfScore>this.opponentScore?n.Manager.Client.WinPopup():n.Manager.Client.LosePopup();return}},i.prototype.NextRound=function(){t^=!0,n.Manager.Server.UpdateRound(t)},i}(),n.Game=e})(BoxR||(BoxR={}));
//@ sourceMappingURL=BoxR.Game.min.js.map